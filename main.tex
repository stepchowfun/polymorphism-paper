\documentclass[acmlarge]{acmart}

\usepackage{booktabs} % For formal tables
\usepackage{bussproofs}
\usepackage{amssymb}
\usepackage{mdframed}
\usepackage{mathtools}
\usepackage{stackengine} % For stacking axioms
\usepackage{listings} % For typesetting code

\usepackage[ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}
\IncMargin{-\parindent}

% Metadata Information
\acmJournal{PACMPL}
\acmVolume{22}
\acmNumber{4}
\acmArticle{39}
\acmYear{2017}
\acmMonth{3}
\acmArticleSeq{11}

%\acmBadgeR[http://ctuning.org/ae/ppopp2016.html]{ae-logo}
%\acmBadgeL[http://ctuning.org/ae/ppopp2016.html]{ae-logo}


% Copyright
\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

% DOI
\acmDOI{0000001.0000001}

% Paper history
\received{February 2017}

% Document starts
\begin{document}
% Title portion
\title{Higher-rank implicit parameters}
\author{Stephan Boyer}
\orcid{1234-5678-9012-3456}
\affiliation{%
  \institution{Airbnb}
  \streetaddress{888 Brannan St.}
  \city{San Francisco}
  \state{CA}
  \postcode{94134}
  \country{USA}
}
\author{Esther Wang}
\affiliation{%
  \institution{Airbnb}
  \streetaddress{888 Brannan St.}
  \city{San Francisco}
  \state{CA}
  \postcode{94134}
  \country{USA}
}


\begin{abstract}
  We introduce $\thesystem$.
\end{abstract}


%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10003752.10010124.10010125.10010127</concept_id>
<concept_desc>Theory of computation~Functional constructs</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010125.10010130</concept_id>
<concept_desc>Theory of computation~Type structures</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010125.10010129</concept_id>
<concept_desc>Theory of computation~Program schemes</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010131.10010134</concept_id>
<concept_desc>Theory of computation~Operational semantics</concept_desc>
<concept_significance>100</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Theory of computation~Functional constructs}
\ccsdesc[500]{Theory of computation~Type structures}
\ccsdesc[300]{Theory of computation~Program schemes}
\ccsdesc[100]{Theory of computation~Operational semantics}

%
% End generated code
%



\newtheorem{case}{Case}



% Misc
\newcommand\thesystem{\left\langle\lambda\right\rangle}
\newcommand\parens[1]{\left(#1\right)}
\newcommand\entails[2]{#1 \vdash #2}
\newcommand\hastype[2]{#1 : #2}
\newcommand\freevars[1]{\text{free}\parens{#1}}
\newcommand\preordersym{\sqsubseteq}
\newcommand\preorder[2]{#1 \preordersym #2}

% Terms
\newcommand\lterm{t}
\newcommand\lvar{x}
\newcommand\labs[2]{\lambda #1 \ . \ #2}
\newcommand\lapp[2]{#1 \ #2}
\newcommand\llet[3]{\text{let } #1 = #2 \text{ in } #3}
\newcommand\lprovide[3]{\text{provide } #1 \text{ as } #2 \text{ in } #3}
\newcommand\limplicit[1]{\left\langle #1 \right\rangle}

% Types
\newcommand\tmono{\tau}
\newcommand\tpoly{\sigma}
\newcommand\tvarempty{\epsilon_{\tpoly}}
\newcommand\tvar{\alpha}
\newcommand\tarrow[2]{#1 \rightarrow #2}
\newcommand\tforall[3]{\forall #1 \ . \ #2 \Rightarrow #3}
\newcommand\tgen[3]{\text{gen}\parens{#1, #2, #3}}
\newcommand\tinst[1]{\text{inst}(#1)}
\newcommand\tmgu[2]{\text{mgu}\parens{#1, #2}}

% Type contexts
\newcommand\gcontext{\Gamma}
\newcommand\gempty{\epsilon_{\gcontext}}

% Implicit contexts
\newcommand\icontext{\Delta}
\newcommand\iempty{\epsilon_{\icontext}}

% Substitutions
\newcommand\ssub{\theta}
\newcommand\sempty{\epsilon_{\ssub}}
\newcommand\sub[3]{#1 \left[ #2 \mapsto #3 \right]}
\newcommand\slub[2]{#1 \vee #2}

% Translation semantics
\newcommand\utrans[2]{#1 \leadsto #2}
\newcommand\uelab[2]{#1 \hookrightarrow #2}
\newcommand\utovar[1]{\| #1 \|}



% We no longer use \terms command
\terms{}

\keywords{Ad hoc polymorphism, Implicit parameters, Overloading, Type classes}


\thanks{
}


\maketitle

\section{Introduction}

  Suppose we wish to write a polymorphic function

  \[ \texttt{square x = x * x} \]

  \noindent defined over any type of value supporting multiplication. What type should we ascribe to this function?

  The idea of being able to provide a separate definition for multiplication over various types is called \emph{ad hoc polymorphism}.



\section{Types for implicit parameters}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{tabular}{l l l}
        $\lterm \Coloneqq $ & & (term) \\
        & $\lvar$ & (variable) \\
        & $\labs{\lvar}{\lterm}$ & (abstraction) \\
        & $\lapp{\lterm}{\lterm}$ & (application) \\
        & $\llet{\lvar}{\lterm}{\lterm}$ & (let binding) \\
        & $\lprovide{\lterm}{\tpoly}{\lterm}$ & (provide binding) \\
        & $\limplicit{\tmono}$ & (implicit parameter)
      \end{tabular}

    \end{mdframed}
    \caption{Syntax of terms}
    \label{fig:terms_syntax}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{tabular}{l l l}
        $\tmono \Coloneqq$ & & (monomorphic type) \\
        & $\tarrow{\tmono}{\tmono}$ & (arrow type) \\
        & $\tvar$ & (type variable) \\
        $\tpoly \Coloneqq$ & & (polymorphic type) \\
        & $\tforall{\overline{\tvar}}{\icontext}{\tmono}$ & (universal type) \\
        $\overline{\tvar} \Coloneqq$ & & (quantified type variables) \\
        & $\tvarempty$ & (empty quantification) \\
        & $\overline{\tvar}, {\tvar}$ & (type variable cons) \\
        $\gcontext \Coloneqq$ & & (type context) \\
        & $\gempty$ & (empty context) \\
        & $\gcontext, \hastype{\lvar}{\tpoly}$ & (context cons) \\
        $\icontext \Coloneqq$ & & (implicit context) \\
        & $\iempty$ & (empty context) \\
        & $\icontext, \tpoly$ & (context cons)
      \end{tabular}

    \end{mdframed}
    \caption{Syntax of types}
    \label{fig:types_syntax}
  \end{figure}

  \[ \icontext, \iempty = \icontext \]
  \[ \icontext_1, \parens{\icontext_2, \tpoly} = \parens{\icontext_1, \icontext_2}, \tpoly \]

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\preorder{\icontext}{\icontext}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{(\textsc{R-Reflexivity})}
        \UnaryInfC{$\preorder{\icontext}{\icontext}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\preorder{\icontext_1}{\icontext_2}$}
          \AxiomC{$\preorder{\icontext_2}{\icontext_3}$}
        \RightLabel{(\textsc{R-Transitivity})}
        \BinaryInfC{$\preorder{\icontext_1}{\icontext_3}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\preorder{\icontext_1}{\icontext_2}$}
        \RightLabel{(\textsc{R-Weakening})}
        \UnaryInfC{$\preorder{\icontext_1}{\icontext_2, \tpoly}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\preorder{\icontext_1, \tpoly_1, \tpoly_2, \icontext_2}{\icontext_3, \tpoly_1, \tpoly_2, \icontext_4}$}
        \RightLabel{(\textsc{R-Permutation})}
        \UnaryInfC{$\preorder{\icontext_1, \tpoly_1, \tpoly_2, \icontext_2}{\icontext_3, \tpoly_2, \tpoly_1, \icontext_4}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\preorder{\icontext_1, \sub{\icontext_2}{\overline{\tvar}}{\overline{\tmono}}, \tforall{\overline{\tvar}}{\icontext_2}{\tmono}}{\icontext_3}$}
        \RightLabel{(\textsc{R-Specialization})}
        \UnaryInfC{$\preorder{\icontext_1, \sub{\icontext_2}{\overline{\tvar}}{\overline{\tmono}}, \tforall{\overline{\tvar}}{\icontext_2}{\tmono}, \sub{\tforall{\tvarempty}{\iempty}{\tmono}}{\overline{\tvar}}{\overline{\tmono}}}{\icontext_3}$}
      \end{prooftree}

    \end{mdframed}
    \caption{Preorder on implicit contexts}
    \label{fig:context_preorder}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\icontext$ coherent}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{(\textsc{C-Empty})}
        \UnaryInfC{$\iempty$ coherent}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{}
          \RightLabel{(\textsc{C-Singleton})}
        \UnaryInfC{$\tpoly, \iempty$ coherent}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\tmgu{\tmono_1}{\tmono_2} = \bot$}
          \AxiomC{$\icontext, \tforall{\overline{\tvar_1}}{\icontext_1}{\tmono_1}$ coherent}
        \RightLabel{(\textsc{C-Coherence})}
        \BinaryInfC{$\icontext, \tforall{\overline{\tvar_1}}{\icontext_1}{\tmono_1}, \tforall{\overline{\tvar_2}}{\icontext_2}{\tmono_2}$ coherent}
      \end{prooftree}

    \end{mdframed}
    \caption{Coherence of implicit contexts}
    \label{fig:context_coherence}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\entails{\icontext; \gcontext}{\hastype{\lterm}{\tmono}}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{$\hastype{\lvar}{\tforall{\overline{\tvar}}{\icontext_1}{\tmono}} \in \gcontext$}
          \AxiomC{$\preorder{\icontext_1}{\icontext_2}$}
        \RightLabel{(\textsc{T-Variable})}
        \BinaryInfC{$\entails{\icontext_2; \gcontext}{\hastype{\lvar}{\sub{\tmono}{\overline{\tvar}}{\overline{\tmono}}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\icontext; \gcontext, \hastype{\lvar}{\tforall{\tvarempty}{\iempty}{\tmono_1}}}{\hastype{\lterm}{\tmono_2}}$}
        \RightLabel{(\textsc{T-Abstraction})}
        \UnaryInfC{$\entails{\icontext; \gcontext}{\hastype{\labs{\lvar}{\lterm}}{\tarrow{\tmono_1}{\tmono_2}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\icontext; \gcontext}{\hastype{\lterm_1}{\tarrow{\tmono_2}{\tmono_1}}}$}
          \AxiomC{$\entails{\icontext; \gcontext}{\hastype{\lterm_2}{\tmono_2}}$}
        \RightLabel{(\textsc{T-Application})}
        \BinaryInfC{$\entails{\icontext; \gcontext}{\hastype{\lapp{\lterm_1}{\lterm_2}}{\tmono_1}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\icontext_1; \gcontext}{\hastype{\lterm_1}{\tmono_1}}$}
          \AxiomC{$\entails{\icontext_2; \gcontext, \hastype{\lvar}{\tforall{\overline{\tvar}}{\icontext}{\tmono_1}}}{\hastype{\lterm_2}{\tmono_2}}$}
          \AxiomC{$\overline{\tvar} = \parens{\freevars{\icontext}, \freevars{\tmono_1}} \setminus \freevars{\gcontext}$}
        \RightLabel{(\textsc{T-Let})}
        \TrinaryInfC{$\entails{\icontext_2; \gcontext}{\hastype{\llet{\lvar}{\lterm_1}{\lterm_2}}{\tmono_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\overline{\tvar_1} \text{ new}$} {$\entails{\icontext_1; \gcontext}{\hastype{\lterm_1}{\tmono_1}}$} {$\entails{\icontext_2, \tpoly; \gcontext}{\hastype{\lterm_2}{\tmono_2}}$} {$\icontext_2, \tpoly$ coherent} {$\tpoly = \tforall{\overline{\tvar_1}}{\icontext_1}{\tmono_3}$} {$\tmono_3 = \sub{\tmono_1}{\overline{\tvar_2}}{\overline{\tmono_4}}$} {$\overline{\tvar_2} = \freevars{\tmono_1} \setminus \parens{\freevars{\icontext_1}, \freevars{\gcontext}}$}}}
        \RightLabel{(\textsc{T-Provide})}
        \UnaryInfC{$\entails{\icontext_2; \gcontext}{\hastype{\lprovide{\lterm_1}{\tpoly}{\lterm_2}}{\tmono_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\preorder{\tforall{\tvarempty}{\iempty}{\tmono}, \iempty}{\icontext}$}
        \RightLabel{(\textsc{T-Implicit})}
          \UnaryInfC{$\entails{\icontext; \gcontext}{\hastype{\limplicit{\tmono}}{\tmono}}$}
      \end{prooftree}

    \end{mdframed}
    \caption{Typing rules}
    \label{fig:typing_rules}
  \end{figure}

\section{Type inference}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\entails{\ssub; \icontext; \icontext; \gcontext}{\hastype{\lterm}{\tmono}}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{$\hastype{\lvar}{\tforall{\overline{\tvar_1}}{\icontext}{\tmono}} \in \gcontext$}
          \AxiomC{$\overline{\tvar_2}$ new}
        \RightLabel{(\textsc{I-Variable})}
        \BinaryInfC{$\entails{\sempty; \iempty; \tinst{\sub{\icontext}{\overline{\tvar_1}}{\overline{\tvar_2}}}; \gcontext}{\hastype{\lvar}{\sub{\tmono}{\overline{\tvar_1}}{\overline{\tvar_2}}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\ssub; \icontext_1; \icontext_2; \gcontext, \hastype{\lvar}{\tforall{\tvarempty}{\iempty}{\tvar}}}{\hastype{\lterm}{\tmono}}$}
          \AxiomC{$\tvar$ new}
        \RightLabel{(\textsc{I-Abstraction})}
        \BinaryInfC{$\entails{\ssub; \ssub \parens{\icontext_1; \icontext_2}; \gcontext}{\hastype{\labs{\lvar}{\lterm}}{\ssub \parens{\tarrow{\tvar}{\tmono}}} }$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\entails{\ssub_1; \icontext_1; \icontext_2; \gcontext}{\hastype{\lterm_1}{\tarrow{\tmono_3}{\tmono_1}}}$} {$\entails{\ssub_2; \icontext_3; \icontext_4; \gcontext}{\hastype{\lterm_2}{\tmono_2}}$} {$\ssub_3 = \slub{\slub{\ssub_1}{\ssub_2}}{\tmgu{\tmono_3}{\tmono_2}}$}}}
        \RightLabel{(\textsc{I-Application})}
        \UnaryInfC{$\entails{\ssub_3; \ssub_3 \parens{\icontext_1, \icontext_3}; \ssub_3 \parens{\icontext_2, \icontext_4}; \gcontext}{\hastype{\lapp{\lterm_1}{\lterm_2}}{\ssub_3 \tmono_1}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\entails{\ssub_1; \icontext_1; \icontext_2; \gcontext}{\hastype{\lterm_1}{\tmono_1}}$} {$\entails{\ssub_2; \icontext_3; \icontext_4; \gcontext, \hastype{\lvar}{\tforall{\overline{\tvar}}{\icontext_2}{\tmono_1}}}{\hastype{\lterm_2}{\tmono_2}}$} {$\overline{\tvar} = \parens{\freevars{\icontext_2}, \freevars{\tmono_1}} \setminus \freevars{\ssub_1 \gcontext}$} {$\ssub_3 = \slub{\ssub_1}{\ssub_2}$}}}
        \RightLabel{(\textsc{I-Let})}
        \UnaryInfC{$\entails{\ssub_3; \ssub_3 \parens{\icontext_1, \icontext_3}; \ssub_3 \icontext_4; \gcontext}{\hastype{\llet{\lvar}{\lterm_1}{\lterm_2}}{\ssub_3 \tmono_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{
            {$\entails{\ssub_1; \icontext_1; \icontext_2; \gcontext}{\hastype{\lterm_1}{\tmono_1}}$}
            {$\entails{\ssub_2; \icontext_3; \icontext_4; \gcontext}{\hastype{\lterm_2}{\tmono_2}}$}
            {$\ssub_3 \parens{\icontext_1, \icontext_3, \tpoly}$ coherent}
            {$\tpoly = \tforall{\overline{\tvar_1}}{\icontext_5}{\tmono_3}$}
            {$\tmono_3 = \sub{\tmono_1}{\overline{\tvar_2}}{\overline{\tmono_4}}$}
            {$\ssub_3 = \slub{\ssub_1}{\ssub_2}$}
            {$\preorder{\icontext_2}{\icontext_5}$}
            {$\overline{\tvar_2} = \freevars{\tmono_1} \setminus \freevars{\gcontext}$}
            {$\icontext_6 = \{\tforall{\overline{\tvar_3}}{\icontext_7}{\tmono_5} : \icontext_4 | \ \tmgu{\tmono_5}{\tmono_1} = \bot \}$}
          }}
        \RightLabel{(\textsc{I-Provide})}
        \UnaryInfC{$\entails{\ssub_3; \ssub_3 \parens{\icontext_1, \icontext_3, \tpoly}; \ssub_3 \icontext_6; \gcontext}{\hastype{\lprovide{\lterm_1}{\tpoly}{\lterm_2}}{\ssub_3 \tmono_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{(\textsc{I-Implicit})}
        \UnaryInfC{$\entails{\sempty; \iempty; \iempty, \tforall{\tvarempty}{\iempty}{\tmono}; \gcontext}{\hastype{\limplicit{\tmono}}{\tmono}}$}
      \end{prooftree}

      \[ \tinst{\tforall{\overline{\tvar_1}}{\iempty}{\tmono}} = \sub{\tmono}{\overline{\tvar_1}}{\overline{\tvar_2}} \qquad \text{where } \overline{\tvar_2} \text{ new} \]

      \[ \tinst{\icontext_1, \tforall{\overline{\tvar_1}}{\icontext_2}{\tmono}} = \tinst{\icontext_1}, \tinst{\sub{\icontext_2}{\overline{\tvar_1}}{\overline{\tvar_2}}}, \tforall{\tvarempty}{\iempty}{\sub{\tmono}{\overline{\tvar_1}}{\overline{\tvar_2}}} \qquad \text{where } \overline{\tvar_2} \text{ new} \]

    \end{mdframed}
    \caption{Inference rules}
    \label{fig:inference_rules}
  \end{figure}

\section{Translation semantics}

  \begin{figure}[h!]
    \begin{mdframed}
      \begin{center}
        \framebox{$\utrans{\icontext}{d}$}
      \end{center}

      \[ \utrans{\tpoly_1, \tpoly_2, \ldots, \tpoly_n}{(\utovar{\tpoly_1}, \utovar{\tpoly_2}, \ldots, \utovar{\tpoly_n})} \]

      \vspace{0.3cm}

      \begin{center}
        \framebox{$\uelab{d}{d'}$}
      \end{center}

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{\textsc{(E-Unit)}}
        \UnaryInfC{$\entails{\icontext}{\uelab{\parens{}}{\parens{}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\icontext_1}{\uelab{d_1}{e_1}, \ldots, \uelab{d_n}{e_n}}$}
        \RightLabel{\textsc{(E-Tuple)}}
        \UnaryInfC{$\entails{\icontext_1}{\uelab{\parens{d_1, \ldots, d_n}}{\parens{e_1, \ldots, e_n}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\tpoly = \tforall{\overline{\tvar}}{\icontext_2}{\tmono}$}
          \AxiomC{$\icontext_3, \tpoly,\icontext_4 = \icontext_1$}
          \AxiomC{$\utrans{\icontext_2}{d}$}
          \AxiomC{$\entails{\icontext_1}{\uelab{d}{e}}$}
        \RightLabel{\textsc{(E-Application)}}
        \QuaternaryInfC{$\entails{\icontext_1}{\uelab{\utovar{\tpoly}}{\lapp{\utovar{\tpoly}}{e}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\tpoly_1 = \tforall{\tvarempty}{\iempty}{\tmono_1}$} {$\tpoly_2 = \tforall{\overline{\tvar}}{\icontext_2}{\tmono_2}$} {$\icontext_3, \tpoly_2,\icontext_4 = \icontext_1$} {$\sub{\tmono_2}{\overline{\tvar}}{\overline{\tmono}} = \tmono_1$} {$\preorder{\sub{\icontext_2}{\overline{\tvar}}{\overline{\tmono}}}{\icontext_1}$} {$\entails{\icontext_1}{\uelab{\utovar{\tpoly_2}}{t}}$}}}
        \RightLabel{(\textsc{E-Lookup})}
        \UnaryInfC{$\entails{\icontext_1}{\uelab{\utovar{\tpoly_1}}}{t}$}
      \end{prooftree}

      \[ \text{\textsc{E-Lookup} applies only if \textsc{E-Application} does not} \]

    \end{mdframed}
    \caption{Elaboration(?) semantics}
    \label{fig:elaboration_semantics}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}
      \begin{center}
        \framebox{$\utrans{\icontext}{d}$}
      \end{center}

      \[ \utrans{\tpoly_1, \tpoly_2, \ldots, \tpoly_n}{(\utovar{\tpoly_1}, \utovar{\tpoly_2}, \ldots, \utovar{\tpoly_n})} \]

      \vspace{0.3cm}

      \begin{center}
        \framebox{$\entails{\icontext; \gcontext}{\utrans{\hastype{\lterm}{\tmono}}{\lterm}}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{$\hastype{\lvar}{\tforall{\overline{\tvar}}{\icontext_1}{\tmono}} \in \gcontext$}
          \AxiomC{$\preorder{\icontext_1}{\icontext_2}$}
          \AxiomC{$\utrans{\icontext_1}{d}$}
          \AxiomC{$\entails{\icontext_2}{\uelab{d}{e}}$}
        \RightLabel{(\textsc{S-Variable})}
\QuaternaryInfC{$\entails{\icontext_2; \gcontext}{\utrans{\hastype{\lvar}{\sub{\tmono}{\overline{\tvar}}{\overline{\tmono}}}}{\lapp{\lvar}{e}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\icontext; \gcontext, \hastype{\lvar}{\tforall{\tvarempty}{\iempty}{\tmono_1}}}{\utrans{\hastype{\lterm}{\tmono_2}}{\lterm'}}$}
        \RightLabel{(\textsc{S-Abstraction})}
        \UnaryInfC{$\entails{\icontext; \gcontext}{\utrans{\hastype{\labs{\lvar}{\lterm}}{\tarrow{\tmono_1}{\tmono_2}}}{\labs{\lvar}{\lterm'}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\icontext; \gcontext}{\utrans{\hastype{\lterm_1}{\tarrow{\tmono_2}{\tmono_1}}}{\lterm_1'}}$}
          \AxiomC{$\entails{\icontext; \gcontext}{\utrans{\hastype{\lterm_2}{\tmono_2}}}{\lterm_2'}$}
        \RightLabel{(\textsc{S-Application})}
        \BinaryInfC{$\entails{\icontext; \gcontext}{\utrans{\hastype{\lapp{\lterm_1}{\lterm_2}}{\tmono_1}}{\lapp{\lterm_1'}{(\labs{\parens{}}{\lterm_2'})}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\entails{\icontext_1; \gcontext}{\utrans{\hastype{\lterm_1}{\tmono_1}}}{\lterm_1'}$} {$\utrans{\icontext_1}{d}$} {$\entails{\icontext_2; \gcontext, \hastype{\lvar}{\tgen{\icontext_1}{\tmono_1}{\freevars{\gcontext}}}}{\utrans{\hastype{\lterm_2}{\tmono_2}}}{\lterm_2'}$}}}
        \RightLabel{(\textsc{S-Let})}
        \UnaryInfC{$\entails{\icontext_2; \gcontext}{\utrans{\hastype{\llet{\lvar}{\lterm_1}{\lterm_2}}{\tmono_2}}{\lapp{(\labs{\lvar}{\lterm_2'})}{(\labs{d}{\lterm_1'})}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\tpoly = \tforall{\overline{\tvar}}{\icontext_1}{\tmono_1}$} {$\utrans{\icontext_1}{d}$} {$\entails{\icontext_1; \gcontext}{\utrans{\hastype{\lterm_1}{\sub{\tmono_1}{\overline{\tvar}}{\overline{\tmono}}}}{\lterm_1'}}$} {$\entails{\tpoly, \icontext_2; \gcontext}{\utrans{\hastype{\lterm_2}{\tmono_2}}{\lterm_2'}}$} {$\tpoly, \icontext_2$ coherent}}}
        \RightLabel{(\textsc{S-Provide})}
        \UnaryInfC{$\entails{\icontext_2; \gcontext}{\utrans{\hastype{\lprovide{\lterm_1}{\tpoly}{\lterm_2}}{\tmono_2}}{(\labs{\utovar{\tpoly}}{\lterm_2'}) (\labs{d}{\lterm_1'})}}$}
      \end{prooftree}

      \begin{prooftree}
         % \AxiomC{\Shortstack[c]{{$\tmono_1 = \sub{\tmono_2}{\overline{\tvar}}{\overline{\tmono}}$} {$\tpoly = \tforall{\overline{\tvar}}{\icontext_1}{\tmono_2}$} {$\tpoly \in \icontext_2$} {$\preorder{\sub{\icontext_1}{\overline{\tvar}}{\overline{\tmono}}}{\icontext_2}$} {$\entails{\icontext_2; \gcontext}{\utrans{\hastype{\utovar{\tpoly}}{\tmono_3}}{\utovar{\tpoly'}}}$}}}
          \AxiomC{$\preorder{\tforall{\tvarempty}{\iempty}{\tmono}, \iempty}{\icontext}$}
          \AxiomC{$\entails{\icontext}{\uelab{\utovar{\tforall{\tvarempty}{\iempty}{\tmono}}}{d}}$}
        \RightLabel{(\textsc{S-Implicit})}
        \BinaryInfC{$\entails{\icontext; \gcontext}{\utrans{\hastype{\limplicit{\tmono}}{\tmono}}{d}}$}
      \end{prooftree}

      \[ \tgen{\icontext}{\tmono}{\overline{\tvar_1}} = \tforall{\overline{\tvar_2}}{\icontext}{\tmono} \qquad \text{where } \overline{\tvar_2} = \parens{\freevars{\icontext}, \freevars{\tmono}} \setminus \overline{\tvar_1} \]

    \end{mdframed}
    \caption{Translation semantics}
    \label{fig:translation_semantics}
  \end{figure}

\section{Examples}

\section{Related work}

  \subsection{Type classes}

  \subsection{Qualified types}

  \subsection{Type-based implicit parameters}

\section{Conclusion}

Hello, World!

\begin{acks}

Hello, World!

\end{acks}

% Bibliography
\bibliographystyle{ACM-Reference-Format}
\bibliography{bibliography}



\end{document}
