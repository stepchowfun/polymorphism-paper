\documentclass[acmlarge]{acmart}

\usepackage{booktabs} % For formal tables
\usepackage{bussproofs}
\usepackage{amssymb}
\usepackage{mdframed}
\usepackage{mathtools}
\usepackage{stackengine} % For stacking axioms

\usepackage[ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}
\IncMargin{-\parindent}

% Metadata Information
\acmJournal{PACMPL}
\acmVolume{22}
\acmNumber{4}
\acmArticle{39}
\acmYear{2017}
\acmMonth{3}
\acmArticleSeq{11}

%\acmBadgeR[http://ctuning.org/ae/ppopp2016.html]{ae-logo}
%\acmBadgeL[http://ctuning.org/ae/ppopp2016.html]{ae-logo}


% Copyright
\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

% DOI
\acmDOI{0000001.0000001}

% Paper history
\received{February 2017}


% Misc
\newcommand\lambdaarobase{\lambda_@}
\newcommand\entails[2]{#1 \vdash #2}
\newcommand\hastype[2]{#1 : #2}
\newcommand\freevars[1]{\text{free} \left( #1 \right)}
\newcommand\generalize[3]{\text{gen}\left( #1, #2, #3 \right)}
\newcommand\sub[3]{#1 \left[ #2 \mapsto #3 \right]}

% Terms
\newcommand\labs[2]{\lambda #1 \ . \ #2}
\newcommand\app[2]{#1 \ #2}
\newcommand\llet[3]{\text{let } #1 = #2 \text{ in } #3}
\newcommand\provide[3]{\text{provide } #1 \text{ as } #2 \text{ in } #3}
\newcommand\implicit[1]{ @ \! \left( #1 \right) }

% Types
\newcommand\larrow[2]{#1 \rightarrow #2}
\newcommand\tabs[3]{\forall #1 \ . \ #2 \Rightarrow #3}
\newcommand\inst[1]{\text{inst}(#1)}
\newcommand\mgu[2]{\text{mgu}\left(#1, #2\right)}

% Inference
\newcommand\lub[2]{#1 \vee #2}

% Translation
\newcommand\trans[2]{#1 \leadsto #2}

% Document starts
\begin{document}
% Title portion
\title{Ad hoc polymorphism}
\author{Stephan Boyer}
\orcid{1234-5678-9012-3456}
\affiliation{%
  \institution{Airbnb}
  \streetaddress{888 Brannan St.}
  \city{San Francisco}
  \state{CA}
  \postcode{94134}
  \country{USA}
}
\author{Esther Wang}
\affiliation{%
  \institution{Airbnb}
  \streetaddress{888 Brannan St.}
  \city{San Francisco}
  \state{CA}
  \postcode{94134}
  \country{USA}
}


\begin{abstract}
  We introduce $\lambdaarobase$.
\end{abstract}


%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10003752.10010124.10010125.10010127</concept_id>
<concept_desc>Theory of computation~Functional constructs</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010125.10010130</concept_id>
<concept_desc>Theory of computation~Type structures</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010125.10010129</concept_id>
<concept_desc>Theory of computation~Program schemes</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010131.10010134</concept_id>
<concept_desc>Theory of computation~Operational semantics</concept_desc>
<concept_significance>100</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Theory of computation~Functional constructs}
\ccsdesc[500]{Theory of computation~Type structures}
\ccsdesc[300]{Theory of computation~Program schemes}
\ccsdesc[100]{Theory of computation~Operational semantics}

%
% End generated code
%

% We no longer use \terms command
\terms{}

\keywords{Ad hoc polymorphism, Implicit parameters, Overloading, Type classes}


\thanks{
}


\maketitle

\section{Introduction}

  We introduce $\lambdaarobase$.

\section{Implicit parameters}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{tabular}{l l l}
        $t \Coloneqq $ & & (term) \\
        & $x$ & (variable) \\
        & $\labs{x}{t}$ & (abstraction) \\
        & $\app{t}{t}$ & (application) \\
        & $\llet{x}{t}{t}$ & (let binding) \\
        & $\provide{t}{\sigma}{t}$ & (provide binding) \\
        & $\implicit{\tau}$ & (implicit parameter)
      \end{tabular}

    \end{mdframed}
    \caption{Syntax of terms}
    \label{fig:terms_syntax}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{tabular}{l l l}
        $\tau \Coloneqq$ & & (monomorphic type) \\
        & $\larrow{\tau}{\tau}$ & (arrow type) \\
        & $\alpha$ & (type variable) \\
        $\sigma \Coloneqq$ & & (polymorphic type) \\
        & $\tabs{\overline{\alpha}}{\Delta}{\tau}$ & (universal type) \\
        $\overline{\alpha} \Coloneqq$ & & (quantified type variables) \\
        & $\epsilon$ & (empty quantification) \\
        & $\alpha, \overline{\alpha}$ & (type variable cons) \\
        $\Gamma \Coloneqq$ & & (type context) \\
        & $\epsilon$ & (empty context) \\
        & $x : \sigma, \Gamma$ & (context cons) \\
        $\Delta \Coloneqq$ & & (implicit context) \\
        & $\epsilon$ & (empty context) \\
        & $\sigma, \Delta$ & (context cons)
      \end{tabular}

    \end{mdframed}
    \caption{Syntax of types}
    \label{fig:types_syntax}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\Delta \sqsubseteq \Delta$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{(\textsc{R-Reflexivity})}
        \UnaryInfC{$\Delta \sqsubseteq \Delta$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\Delta_1 \sqsubseteq \Delta_2$}
          \AxiomC{$\Delta_2 \sqsubseteq \Delta_3$}
        \RightLabel{(\textsc{R-Transitivity})}
        \BinaryInfC{$\Delta_1 \sqsubseteq \Delta_3$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{(\textsc{R-Contraction})}
        \UnaryInfC{$\sigma, \sigma, \Delta \sqsubseteq \sigma, \Delta$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{}
        \RightLabel{(\textsc{R-Weakening})}
        \UnaryInfC{$\Delta \sqsubseteq \sigma, \Delta$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\sigma_1, \epsilon \sqsubseteq \Delta_2$}
          \AxiomC{$\sigma_2, \epsilon \sqsubseteq \Delta_1$}
          \AxiomC{$\sigma_2, \sub{\Delta_1}{\sigma_2}{\sigma_1} \sqsubseteq \sigma_1, \sub{\Delta_2}{\sigma_1}{\sigma_2}$}
        \RightLabel{(\textsc{R-Permutation})}
        \TrinaryInfC{$\sigma_1, \Delta_1 \sqsubseteq \sigma_2, \Delta_2$}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{$\Delta_1 \sqsubseteq \sub{\tabs{\epsilon}{\epsilon}{\tau}}{\overline{\alpha}}{\overline{\tau}}, \Delta_2$}
          \AxiomC{$\tabs{\overline{\alpha}}{\Delta_3}{\tau}, \sub{\Delta_3}{\overline{\alpha}}{\overline{\tau}} \sqsubseteq \Delta_2$}
        \RightLabel{(\textsc{R-Specialization})}
        \BinaryInfC{$\Delta_1 \sqsubseteq \Delta_2$}
      \end{prooftree}

    \end{mdframed}
    \caption{Preorder on implicit contexts}
    \label{fig:context_preorder}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\Delta$ coherent}
      \end{center}

      \medskip

      \begin{prooftree}
        \AxiomC{}
        \RightLabel{(\textsc{C-Empty})}
        \UnaryInfC{$\epsilon$ coherent}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{}
        \RightLabel{(\textsc{C-Singleton})}
        \UnaryInfC{$\sigma, \epsilon$ coherent}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\mgu{\tau_1}{\tau_2} = \bot$}
          \AxiomC{$\tabs{\overline{\alpha_1}}{\Delta_1}{\tau_1}, \Delta$ coherent}
        \RightLabel{(\textsc{C-Coherence})}
        \BinaryInfC{$\tabs{\overline{\alpha_1}}{\Delta_1}{\tau_1}, \tabs{\overline{\alpha_2}}{\Delta_2}{\tau_2}, \Delta$ coherent}
      \end{prooftree}

    \end{mdframed}
    \caption{Coherence of implicit contexts}
    \label{fig:context_coherence}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\entails{\Delta; \Gamma}{\hastype{t}{\tau}}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{$\hastype{x}{\tabs{\overline{\alpha}}{\Delta_1}{\tau}} \in \Gamma$}
          \AxiomC{$\Delta_1 \sqsubseteq \Delta_2$}
        \RightLabel{(\textsc{T-Variable})}
        \BinaryInfC{$\entails{\Delta_2; \Gamma}{\hastype{x}{\sub{\tau}{\overline{\alpha}}{\overline{\tau}}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\Delta; \Gamma, \hastype{x}{\tabs{\epsilon}{\epsilon}{\tau_1}}}{\hastype{t}{\tau_2}}$}
        \RightLabel{(\textsc{T-Abstraction})}
        \UnaryInfC{$\entails{\Delta; \Gamma}{\hastype{\labs{x}{t}}{\larrow{\tau_1}{\tau_2}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\Delta; \Gamma}{\hastype{t_1}{\larrow{\tau_2}{\tau_1}}}$}
          \AxiomC{$\entails{\Delta; \Gamma}{\hastype{t_2}{\tau_2}}$}
        \RightLabel{(\textsc{T-Application})}
        \BinaryInfC{$\entails{\Delta; \Gamma}{\hastype{\app{t_1}{t_2}}{\tau_1}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\Delta_1; \Gamma}{\hastype{t_1}{\tau_1}}$}
          \AxiomC{$\entails{\Delta_2; \Gamma, \hastype{x}{\generalize{\Delta_1}{\Gamma}{\tau_1}}}{\hastype{t_2}{\tau_2}}$}
        \RightLabel{(\textsc{T-Let})}
        \BinaryInfC{$\entails{\Delta_2; \Gamma}{\hastype{\llet{x}{t_1}{t_2}}{\tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\sigma = \tabs{\overline{\alpha}}{\Delta_1}{\tau_1}$} {$\entails{\Delta_1; \Gamma}{\hastype{t_1}{\sub{\tau_1}{\overline{\alpha}}{\overline{\tau}}}}$} {$\entails{\sigma, \Delta_2; \Gamma}{\hastype{t_2}{\tau_2}}$} {$\sigma, \Delta_2$ coherent}}}
        \RightLabel{(\textsc{T-Provide})}
        \UnaryInfC{$\entails{\Delta_2; \Gamma}{\hastype{\provide{t_1}{\sigma}{t_2}}{\tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{$\tabs{\epsilon}{\epsilon}{\tau}, \epsilon \sqsubseteq \Delta$}
        \RightLabel{(\textsc{T-Implicit})}
        \UnaryInfC{$\entails{\Delta; \Gamma}{\hastype{\implicit{\tau}}{\tau}}$}
      \end{prooftree}

      \[ \inst{\tabs{\overline{\alpha_1}}{\epsilon}{\tau}} = \sub{\tau}{\overline{\alpha_1}}{\overline{\alpha_2}} \qquad \text{where } \overline{\alpha_2} \text{ new} \]

      \[ \generalize{\Delta}{\Gamma}{\tau} = \tabs{\overline{\alpha}}{\Delta}{\tau} \qquad \text{where } \overline{\alpha} = \left( \freevars{\Delta}, \freevars{\tau} \right) \setminus \freevars{\Gamma} \]

    \end{mdframed}
    \caption{Typing rules}
    \label{fig:typing_rules}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\entails{\theta; \Delta; \Delta; \Gamma}{\hastype{t}{\tau}}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{$\hastype{x}{\tabs{\overline{\alpha_1}}{\Delta}{\tau}} \in \Gamma$}
          \AxiomC{$\overline{\alpha_2}$ new}
        \RightLabel{(\textsc{I-Variable})}
        \BinaryInfC{$\entails{\epsilon; \epsilon; \inst{\sub{\Delta}{\overline{\alpha_1}}{\overline{\alpha_2}}}; \Gamma}{\hastype{x}{\sub{\tau}{\overline{\alpha_1}}{\overline{\alpha_2}}}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\theta; \Delta_1; \Delta_2; \Gamma, \hastype{x}{\tabs{\epsilon}{\epsilon}{\alpha}}}{\hastype{t}{\tau}}$}
          \AxiomC{$\alpha$ new}
        \RightLabel{(\textsc{I-Abstraction})}
        \BinaryInfC{$\entails{\theta; \theta \left( \Delta_1; \Delta_2 \right); \Gamma}{\hastype{\labs{x}{t}}{\theta \left( \larrow{\alpha}{\tau}} \right) }$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\entails{\theta_1; \Delta_4; \Delta_1; \Gamma}{\hastype{t_1}{\larrow{\tau_3}{\tau_1}}}$} {$\entails{\theta_2; \Delta_5; \Delta_2; \Gamma}{\hastype{t_2}{\tau_2}}$} {$\theta_3 = \lub{\lub{\theta_1}{\theta_2}}{\mgu{\tau_3}{\tau_2}}$}}}
        \RightLabel{(\textsc{I-Application})}
        \UnaryInfC{$\entails{\theta_3; \theta_3 \left( \Delta_4, \Delta_5 \right); \theta_3 \left( \Delta_1, \Delta_2\right); \Gamma}{\hastype{\app{t_1}{t_2}}{\theta_3 \tau_1}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\theta_1; \Delta_3; \Delta_1; \Gamma}{\hastype{t_1}{\tau_1}}$}
          \AxiomC{$\entails{\theta_2; \Delta_4; \Delta_2; \Gamma, \hastype{x}{\generalize{\Delta_1}{\theta_1 \Gamma}{\tau_1}}}{\hastype{t_2}{\tau_2}}$}
          \AxiomC{$\theta_3 = \lub{\theta_1}{\theta_2}$}
        \RightLabel{(\textsc{I-Let})}
        \TrinaryInfC{$\entails{\theta_3; \theta_3 \left( \Delta_3, \Delta_4 \right); \theta_3 \Delta_2; \Gamma}{\hastype{\llet{x}{t_1}{t_2}}{\theta_3 \tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\entails{\theta_1; \Delta_4; \Delta_1; \Gamma}{\hastype{t_1}{\tau_1}}$} {$\entails{\theta_2; \Delta_5; \Delta_2; \Gamma}{\hastype{t_2}{\tau_2}}$} {$\sigma = \tabs{\overline{\alpha_2}}{\Delta_6}{\tau_3}$} {$\sub{\tau_1}{\overline{\alpha_1}}{\overline{\tau_1}} = \sub{\tau_3}{\overline{\alpha_2}}{\overline{\tau_2}}$} {$\Delta_3 = \{ \tabs{\overline{\alpha}}{\Delta}{\tau} \in \Delta_2 | \ \mgu{\tau}{\tau_1} = \bot \}$} {$\theta_3 = \lub{\theta_1}{\theta_2}$} {$\theta_3 \left( \sigma, \Delta_4, \Delta_5 \right)$ coherent}}}
        \RightLabel{(\textsc{I-Provide})}
        \UnaryInfC{$\entails{\theta_3; \theta_3 \left( \sigma, \Delta_4, \Delta_5 \right); \theta_3 \Delta_3; \Gamma}{\hastype{\provide{t_1}{\sigma}{t_2}}{\theta_3 \tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{}
        \RightLabel{(\textsc{I-Implicit})}
        \UnaryInfC{$\entails{\epsilon; \epsilon; \tabs{\epsilon}{\epsilon}{\tau}, \epsilon; \Gamma}{\hastype{\implicit{\tau}}{\tau}}$}
      \end{prooftree}

      \[ \inst{\tabs{\overline{\alpha_1}}{\epsilon}{\tau}} = \sub{\tau}{\overline{\alpha_1}}{\overline{\alpha_2}} \qquad \text{where } \overline{\alpha_2} \text{ new} \]

      \[ \inst{\tabs{\overline{\alpha_1}}{\Delta_1}{\tau}, \Delta_2} = \tabs{\epsilon}{\epsilon}{\sub{\tau}{\overline{\alpha_1}}{\overline{\alpha_2}}}, \inst{\sub{\Delta_1}{\overline{\alpha_1}}{\overline{\alpha_2}}}, \inst{\Delta_2} \qquad \text{where } \overline{\alpha_2} \text{ new} \]

      \[ \generalize{\Delta}{\Gamma}{\tau} = \tabs{\overline{\alpha}}{\Delta}{\tau} \qquad \text{where } \overline{\alpha} = \left( \freevars{\Delta}, \freevars{\tau} \right) \setminus \freevars{\Gamma} \]

    \end{mdframed}
    \caption{Inference rules}
    \label{fig:inference_rules}
  \end{figure}

  \begin{figure}[h!]
    \begin{mdframed}

      \begin{center}
        \framebox{$\entails{\Delta; \Gamma}{\hastype{\trans{t}{t}}{\tau}}$}
      \end{center}

      \medskip

      \begin{prooftree}
          \AxiomC{$x:\tabs{\epsilon}{\epsilon}{\tau} \in \Gamma$}
        \RightLabel{(\textsc{T-Variable})}
        \UnaryInfC{$\hastype{\trans{x}{x}}{\tau}$}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{$\entails{\Delta; \Gamma, \hastype{x}{\tabs{\epsilon}{\epsilon}{\tau_1}}}{\hastype{\trans{t}{t'}}{\tau_2}}$}
        \RightLabel{(\textsc{T-Abstraction})}
        \UnaryInfC{$\entails{\Delta; \Gamma}{\trans{\labs{x}{t}}\hastype{\labs{x}{t'}}}{\larrow{\tau_1}{\tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{$\entails{\Delta; \Gamma}{\hastype{\trans{t_1}{t_1'}}{\larrow{\tau_2}{\tau_1}}}$}
        \AxiomC{$\entails{\Delta; \Gamma}{\hastype{\trans{t_2}{t_2'}}{\tau_2}}$}
        \RightLabel{(\textsc{T-Application})}
        \BinaryInfC{$\entails{\Delta; \Gamma}{\hastype{\trans{\app{t_1}{t_2}}{\app{t_1'}{t_2'}}}{\tau_1}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{$\entails{\Delta_1; \Gamma}{\hastype{t_1}{\tau_1}}$}
          \AxiomC{$\entails{\Delta_2; \Gamma, \hastype{x}{\generalize{\Delta_1}{\Gamma}{\tau_1}}}{\hastype{t_2}{\tau_2}}$}
        \RightLabel{(\textsc{T-Let})}
        \BinaryInfC{$\entails{\Delta_2; \Gamma}{\hastype{\llet{x}{t_1}{t_2}}{\tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
          \AxiomC{\Shortstack[c]{{$\sigma = \tabs{\overline{\alpha}}{\Delta_1}{\tau_1}$} {$\entails{\Delta_1; \Gamma}{\hastype{t_1}{\sub{\tau_1}{\overline{\alpha}}{\overline{\tau}}}}$} {$\entails{\sigma, \Delta_2; \Gamma}{\hastype{t_2}{\tau_2}}$} {$\sigma, \Delta_2$ coherent}}}
        \RightLabel{(\textsc{T-Provide})}
        \UnaryInfC{$\entails{\Delta_2; \Gamma}{\hastype{\provide{t_1}{\sigma}{t_2}}{\tau_2}}$}
      \end{prooftree}

      \begin{prooftree}
        \AxiomC{$\tabs{\epsilon}{\epsilon}{\tau}, \epsilon \sqsubseteq \Delta$}
        \RightLabel{(\textsc{T-Implicit})}
        \UnaryInfC{$\entails{\Delta; \Gamma}{\hastype{\implicit{\tau}}{\tau}}$}
      \end{prooftree}

    \end{mdframed}
    \caption{Translation semantics}
    \label{fig:translation_semantics}
  \end{figure}

\section{Conclusion}

Hello, World!

\begin{acks}

Hello, World!

\end{acks}

% Bibliography
\bibliographystyle{ACM-Reference-Format}
\bibliography{bibliography}



\end{document}
